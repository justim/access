<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.71">
<title data-react-helmet="true">Presenters | Access</title><meta data-react-helmet="true" property="og:url" content="https://access.justim.net/docs/presenters"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Presenters | Access"><meta data-react-helmet="true" name="description" content="Presenters are Access&#x27; way to serialize entities and collection to something you"><meta data-react-helmet="true" property="og:description" content="Presenters are Access&#x27; way to serialize entities and collection to something you"><link data-react-helmet="true" rel="shortcut icon" href="/images/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://access.justim.net/docs/presenters"><link data-react-helmet="true" rel="alternate" href="https://access.justim.net/docs/presenters" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://access.justim.net/docs/presenters" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.8fe4d125.css">
<link rel="preload" href="/assets/js/styles.d34f3c0e.js" as="script">
<link rel="preload" href="/assets/js/runtime~main.067ca8c4.js" as="script">
<link rel="preload" href="/assets/js/main.1c8c57eb.js" as="script">
<link rel="preload" href="/assets/js/1.e6350078.js" as="script">
<link rel="preload" href="/assets/js/2.032c7b22.js" as="script">
<link rel="preload" href="/assets/js/18.95fb1f6b.js" as="script">
<link rel="preload" href="/assets/js/19.fae62a56.js" as="script">
<link rel="preload" href="/assets/js/935f2afb.19372ca8.js" as="script">
<link rel="preload" href="/assets/js/17896441.a4a86342.js" as="script">
<link rel="preload" href="/assets/js/bd97f13f.332fbe8f.js" as="script">
</head>
<body>
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/images/access.png" alt="Access logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/images/access.png" alt="Access logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Access</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/justim/access" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_GrZ2"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/images/access.png" alt="Access logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/images/access.png" alt="Access logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Access</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs">Docs</a></li><li class="menu__list-item"><a href="https://github.com/justim/access" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper main-docs-wrapper"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#!">Access</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/">Introduction</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Features</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/database">Database</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/entities">Entities</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/repositories">Repositories</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/queries">Queries</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/collections">Collections</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/presenters">Presenters</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/transactions">Transactions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/locks">Locks</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/profiler">Profiler</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Presenters</h1></header><div class="markdown"><p>Presenters are Access&#x27; way to serialize entities and collection to something you
can send over the wire with <code>json_encode</code>. To be more specific, it converts
entities to <code>array</code>s and because collections are basically lists of entities,
those get converted to <code>array</code>s of <code>array</code>s.</p><p>But why, you might ask, not just use <code>\JsonSerializable</code> for this? Presenters
add a layer inbetween the entity and the resulting array to allow for more
configuration and flexibility. For example, for different reasons you might want
to expose different fields of a single entity. And, by using the extra layer
Access can provide a lot of helper methods to convert your entities with ease,
including, but not limited to, solving the <code>n+1</code> problem for nested entities.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="simple-entity-presenter"></a>Simple entity presenter<a class="hash-link" href="#simple-entity-presenter" title="Direct link to heading">#</a></h2><p>To start simple you need to create a class that extends the <code>EntityPresenter</code>,
and implement two methods. One to tell which entity is associated with this
presenter (<code>getEntityKlass</code>) and the other to do the converting (<code>fromEntity</code>).</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><div tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token plain">use Access\Presenter\EntityPresenter;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">class UserPresenter extends EntityPresenter</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">{</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    /**</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">     * Get the entity class associated with this presenter</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">     */</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    public static function getEntityKlass(): string</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        return User::class;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    /**</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">     * Convert entity to an array</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">     */</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    public function fromEntity(Entity $user): ?array</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        return [</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            &#x27;id&#x27; =&gt; $user-&gt;getId(),</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        ]</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>To use this presenter you need the <a href="/docs/database"><code>Access\Database</code></a> instance and
call <code>presentEntity</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><div tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token plain">// get a user from somewhere</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">$user = $db-&gt;findOne(User::class, 1);</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">$result = $db-&gt;presentEntity(UserPresenter::class, $user);</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">// =&gt;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">[</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    &#x27;id&#x27; =&gt; 1,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">];</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>As you might have noticed, the return type of the <code>fromEntity</code> method is
<code>?array</code>, indicating that it is possible to return <code>null</code>. Returning <code>null</code>
could help in cases where you don&#x27;t want to output the entity, based on some
kind of logic. For example, you never want to return admin users from your
entity presenter, just return <code>null</code> when the user is an admin and the presenter
will completely filter out the user. This is more useful when you have a list of
users and want to filter some out.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="collection-presenters"></a>Collection presenters<a class="hash-link" href="#collection-presenters" title="Direct link to heading">#</a></h2><p>Presenting a collection uses the same presenter as the entity, it just executes
the <code>fromEntity</code> multiple times and puts them in an <code>array</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><div tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token plain">// get a list of users from somewhere</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">$users = $db-&gt;getRepository(User::class)-&gt;findAllCollection();</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">$result = $db-&gt;presentCollection(UserPresenter::class, $users);</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">// =&gt;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">[</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    [</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        &#x27;id&#x27; =&gt; 1,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    ],</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    [</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        &#x27;id&#x27; =&gt; 2,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    ],</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    // ..</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">];</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="nested-presenters"></a>Nested presenters<a class="hash-link" href="#nested-presenters" title="Direct link to heading">#</a></h2><p>To make things more interesting, we need create another presenter, this time for
the <code>Project</code> entity. This <code>ProjectPresenter</code> presenter references another
presenter by using <code>present()</code>, you need to provide the presenter you want to
use for your field and the ID of the entity. Calling the <code>present</code> method does
not really do anything, it merely saves the needed information and &quot;marks&quot; the
location in the result. The presenter will then lookup all the &quot;markers&quot;, fetch
the needed entities in a single query and resolve all the markers with the
result of entity presenter.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><div tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token plain">use Access\Presenter\EntityPresenter;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">class ProjectPresenter extends EntityPresenter</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">{</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    public static function getEntityKlass(): string</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        return Project::class;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    public function fromEntity(Entity $project): ?array</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        return [</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            &#x27;id&#x27; =&gt; $project-&gt;getId(),</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            &#x27;owner&#x27; =&gt; $this-&gt;present(UserPresenter::class, $project-&gt;getOwnerId()),</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        ]</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Executing this entity presenter will automatically create a <code>UserPresenter</code>, fetch
the associated <code>User</code> entity with the ID coming from <code>getOwnerId</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><div tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token plain">// get a project from somewhere</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">$project = $db-&gt;findOne(Project::class, 1);</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">$result = $db-&gt;presentEntity(ProjectPresenter::class, $project);</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">// =&gt;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">[</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    &#x27;id&#x27; =&gt; 1,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    &#x27;owner&#x27; =&gt; [</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        &#x27;id&#x27; =&gt; 1,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    ],</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">];</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>The underlying presenter fetches the needed <code>User</code> entity based on the mark left
my <code>present</code>. This case it is obvious that done with a single query, but this
scales to using this entity presenter for collections as well.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><div tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token plain">// get a list of projects from somewhere</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">$projects = $db-&gt;getRepository(Project::class)-&gt;findAllCollection();</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">$result = $db-&gt;presentCollection(ProjectPresenter::class, $projects);</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">// =&gt;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">[</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    [</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        &#x27;id&#x27; =&gt; 1,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        &#x27;owner&#x27; =&gt; [</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            &#x27;id&#x27; =&gt; 1,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        ],</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    ],</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    [</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        &#x27;id&#x27; =&gt; 2,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        &#x27;owner&#x27; =&gt; [</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            &#x27;id&#x27; =&gt; 2,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        ],</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    ],</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    // ..</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">];</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This is also done with a single query; all the marks are collected, then the
entities are fetched in one go and after that the markers are replaced with the
result of the <code>fromEntity</code> of the associated entity presenter. It is possible
that that result also contains a bunch of marker, like the profile image of the
owner, for example. The presenter will keep resolving the markers for as long as
the are there. Adding a profile image from another entity presenter would only
increase the number of queries with one.</p><p>Of course <code>present</code> is a little bit limited, it only works for <code>has-one</code>
relations. The <code>EntityPresenter</code> provides a bunch more methods to resolve more
complicated relations as well.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="has-many-relation"></a><code>has-many</code> relation<a class="hash-link" href="#has-many-relation" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><div tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token plain">use Access\Presenter\EntityPresenter;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">class UserWithProjectsPresenter extends EntityPresenter</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">{</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    public static function getEntityKlass(): string</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        return User::class;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    public function fromEntity(Entity $user): ?array</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        return [</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            &#x27;id&#x27; =&gt; $user-&gt;getId(),</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            &#x27;projects&#x27; =&gt; $this-&gt;presentMultipleInversedRefs(</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                UserPresenter::class, // entity presenter</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                &#x27;owner_id&#x27;, // field name linking the user to the projects</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                $user-&gt;getId(), // value of the field</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            ),</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        ]</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>In the background this will do a query to fetch all the projects needed to
resolve these markers, something like this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sql"><div tabindex="0" class="prism-code language-sql codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#66d9ef">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">*</span><span class="token plain"> </span><span class="token keyword" style="color:#66d9ef">FROM</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">`</span><span class="token plain">projects</span><span class="token punctuation" style="color:#f8f8f2">`</span><span class="token plain"> </span><span class="token keyword" style="color:#66d9ef">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">`</span><span class="token plain">owner_id</span><span class="token punctuation" style="color:#f8f8f2">`</span><span class="token plain"> </span><span class="token operator" style="color:#66d9ef">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">:userId</span><span class="token punctuation" style="color:#f8f8f2">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>When there are multiple markers that need to be resolved, the query stays the
same, but will include all user IDs that are needed. Then the result is split
when the markers are resolved.</p><p>This entity presenter can be used just like any other.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><div tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token plain">// get a user from somewhere</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">$user = $db-&gt;findOne(User::class, 1);</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">$result = $db-&gt;presentEntity(UserWithProjectsPresenter::class, $user);</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">// =&gt;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">[</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    &#x27;id&#x27; =&gt; 1,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    &#x27;projects&#x27; =&gt; [</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        [</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            &#x27;id&#x27; =&gt; 1,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            &#x27;owner&#x27; =&gt; [</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                &#x27;id&#x27; =&gt; 1,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            ],</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        ],</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    ],</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">];</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>As you can see the <code>owner</code> field of the project is also filled, as that entity
presenter uses <code>UserPresenter</code>. This feature is very powerfu, you can easily
create more complex entity presenters by composing them together. Keep in mind,
though, to prevent circular entity presenters. This will throw an exception.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Avoid circular entity presenters</h5></div><div class="admonition-content"><p>This will completely blow up with an <code>Access\Exception</code>.</p></div></div><p>You can prevent the circular entity presenters is by creating a completely new
one for every need, like we did in our example from above. We created a new
<code>UserWithProjectsPresenter</code> entity presenter to prevent the circular entity
presenter.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="clauses"></a>Clauses<a class="hash-link" href="#clauses" title="Direct link to heading">#</a></h2><p>Even though it is possible to do some manipulation with the future helpers,
this can be cumbersome when you only want to sort them, or filter on an extra
field. That&#x27;s were the optional clauses come into play. You can add an extra
clause to some of the helper methods to provide that extra functionality to the
marker. Currently there are two kinds of clauses that you can use, a condition
to filter on an extra field or ordering the results for the &quot;multiple&quot; helpers.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="condition-clauses"></a>Condition clauses<a class="hash-link" href="#condition-clauses" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><div tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token plain">use Access\Presenter\EntityPresenter;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">use Access\Clause;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">class UserWithPublishedProjectsPresenter extends EntityPresenter</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">{</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    public static function getEntityKlass(): string</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        return User::class;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    public function fromEntity(Entity $user): ?array</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        return [</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            &#x27;id&#x27; =&gt; $user-&gt;getId(),</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            &#x27;publishedProjects&#x27; =&gt; $this-&gt;presentMultipleInversedRefs(</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                UserPresenter::class, // entity presenter</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                &#x27;owner_id&#x27;, // field name linking the user to the projects</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                $user-&gt;getId(), // value of the field</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                new Clause\Condition\Equals(&#x27;status&#x27;, &#x27;PUBLISHED&#x27;),</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            ),</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        ]</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This will only add projects to the <code>&#x27;publishedProjects&#x27;</code> list that are published
(<code>status = &#x27;PUBLISHED&#x27;</code>).</p><p>There are a whole bunch of conditions you can use and their names speak for
themselves.</p><ul><li><code>Access\Clauses\Condition\Equals</code></li><li><code>Access\Clauses\Condition\GreaterThan</code></li><li><code>Access\Clauses\Condition\GreaterThanOrEquals</code></li><li><code>Access\Clauses\Condition\IsNotNull</code></li><li><code>Access\Clauses\Condition\IsNull</code></li><li><code>Access\Clauses\Condition\LessThen</code></li><li><code>Access\Clauses\Condition\LessThanOrEquals</code></li><li><code>Access\Clauses\Condition\NotEquals</code></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ordering-clauses"></a>Ordering clauses<a class="hash-link" href="#ordering-clauses" title="Direct link to heading">#</a></h3><p>To order the projects you can use the <code>Access\Clause\OrderBy</code> clauses.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><div tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token plain">use Access\Presenter\EntityPresenter;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">use Access\Clause;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">class UserWithOrderedProjectsPresenter extends EntityPresenter</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">{</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    public static function getEntityKlass(): string</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        return User::class;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    public function fromEntity(Entity $user): ?array</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        return [</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            &#x27;id&#x27; =&gt; $user-&gt;getId(),</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            &#x27;publishedProjects&#x27; =&gt; $this-&gt;presentMultipleInversedRefs(</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                UserPresenter::class, // entity presenter</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                &#x27;owner_id&#x27;, // field name linking the user to the projects</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                $user-&gt;getId(), // value of the field</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                new Clause\OrderBy\Ascending(&#x27;name&#x27;),</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            ),</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        ]</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>There are only two order by clauses:</p><ul><li><code>Access\Clause\OrderBy\Ascending</code></li><li><code>Access\Clause\OrderBy\Descending</code></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="multiple-clauses"></a>Multiple clauses<a class="hash-link" href="#multiple-clauses" title="Direct link to heading">#</a></h3><p>And if you want to mix multiple clauses together, if, for example, you want the
list to contain published projects and also want to order them. The special
<code>Access\Clauses\Multiple</code> clause will help you here, if combines multiple
conditions together and all conditions need to be true. Or if you provide
multiple order by clauses they all will be used (you can sorting on status and
then on name, for example). There is also the <code>Access\Clauses\MultipleOr</code> clause
if you want only one of the condition clauses to be true. You can add as many
clauses to the <code>Multiple</code> as you like, and you can mix order by and condition
clauses.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><div tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token plain">use Access\Presenter\EntityPresenter;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">use Access\Clause;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">class UserWithOrderedPublishedProjectsPresenter extends EntityPresenter</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">{</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    public static function getEntityKlass(): string</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        return User::class;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    public function fromEntity(Entity $user): ?array</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        return [</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            &#x27;id&#x27; =&gt; $user-&gt;getId(),</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            &#x27;publishedProjects&#x27; =&gt; $this-&gt;presentMultipleInversedRefs(</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                UserPresenter::class, // entity presenter</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                &#x27;owner_id&#x27;, // field name linking the user to the projects</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                $user-&gt;getId(), // value of the field</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                new Clause\Multiple()</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                    new Clause\Condition\Equals(&#x27;status&#x27;, &#x27;PUBLISHED&#x27;),</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                    new Clause\OrderBy\Ascending(&#x27;name&#x27;),</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                ),</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            ),</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        ]</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="presenter-instance"></a><code>Presenter</code> instance<a class="hash-link" href="#presenter-instance" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="dependency-injection"></a>Dependency injection<a class="hash-link" href="#dependency-injection" title="Direct link to heading">#</a></h3><p>Sometimes you need a bit more information than just the entity you are
converting, like some service to generate URLs. The presenter functions like a
rudimentary dependency container. First you need access to the <code>Presenter</code> that
is used for the actual presenting, so far we&#x27;ve only looked at the shortcuts to
skip creating a <code>Presenter</code>. To get an presenter you can just call
<code>createPresenter</code> on the <a href="/docs/database">database</a> instance.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><div tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token plain">// result an `Access\Presenter`</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">$presenter = $db-&gt;createPresenter();</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This presenter instance provides the same methods to do the actual presenting as
the <code>Database</code> instance, <code>presentEntity</code> and <code>presentCollection</code>. But, there are
also some extra methods to prepare your presenting work for a bit more heavy
lifting.</p><p>First up, you can add a dependency to the presenter that your entity presenters
can use.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><div tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token plain">// get a URL service somewhere</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">// for our exmple, this is an `App\UrlService` object</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">$urlService = $this-&gt;getSomeUrlService();</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">$presenter = $db-&gt;createPresenter();</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">$presenter-&gt;addDependency($urlService);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Now your presenter a reference to the URL service, but on its own nothing
happens. We need a way for the entity presenters to access this dependency.
Dependencies are injected into the constructor of the entity presenter and are
matched on type.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><div tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token plain">use Access\Presenter\EntityPresenter;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">class UserWithExternalUrlPresenter extends EntityPresenter</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">{</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    private App\UrlService $urlService;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    public function __construct(App\UrlService $urlService)</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        $this-&gt;urlService = $urlService;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    // .. get presenter class</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    public function fromEntity(Entity $user): ?array</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    {</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        return [</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            &#x27;id&#x27; =&gt; 1,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            &#x27;externalUrl&#x27; =&gt; $this-&gt;urlService-&gt;generate($user),</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        ];</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    }</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Dependencies are only injected into entity presenters with an constructor and
the order of dependencies does not matter. And your entity can also mark the
dependency as optional with a default value for the constructor argument.
Otherwise the presenter will throw an exception when a dependency is not
available.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="providing-collections"></a>Providing collections<a class="hash-link" href="#providing-collections" title="Direct link to heading">#</a></h3><p>In some cases you already know which entities are needed to resolve some
markers, when, for example, you already fetched those entities to does some
calculations. In this case you don&#x27;t what to fetch them again when there is a
marker for one of those entities. You can add those entities as a collection to
the presenter for future use with <code>provideCollection</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><div tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token plain">// the some users from somewhere</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">$users = $db-&gt;getRepository(User::class)-&gt;findAllCollection();</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">// get a project from somewhere</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">$project = $db-&gt;findOne(Project::class, 1);</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">$presenter = $db-&gt;createPresenter();</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">$presenter-&gt;provideCollection(User::class, $users);</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">$result = $presenter-&gt;presentEntity(ProjectPresenter::class, $project);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This will <em>not</em> does additional queries to fetch the user needed for the owner
marker in the <code>ProjectPresenter</code> entity presenter. Unless, of course, the
specific user is not available in the collection; in that case an addition query
will be executed.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/justim/access/edit/master/website/../docs/presenters.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/collections"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Collections</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/transactions"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Transactions Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#simple-entity-presenter" class="table-of-contents__link">Simple entity presenter</a></li><li><a href="#collection-presenters" class="table-of-contents__link">Collection presenters</a></li><li><a href="#nested-presenters" class="table-of-contents__link">Nested presenters</a><ul><li><a href="#has-many-relation" class="table-of-contents__link"><code>has-many</code> relation</a></li></ul></li><li><a href="#clauses" class="table-of-contents__link">Clauses</a><ul><li><a href="#condition-clauses" class="table-of-contents__link">Condition clauses</a></li><li><a href="#ordering-clauses" class="table-of-contents__link">Ordering clauses</a></li><li><a href="#multiple-clauses" class="table-of-contents__link">Multiple clauses</a></li></ul></li><li><a href="#presenter-instance" class="table-of-contents__link"><code>Presenter</code> instance</a><ul><li><a href="#dependency-injection" class="table-of-contents__link">Dependency injection</a></li><li><a href="#providing-collections" class="table-of-contents__link">Providing collections</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Access</div></div></div></footer></div>
<script src="/assets/js/styles.d34f3c0e.js"></script>
<script src="/assets/js/runtime~main.067ca8c4.js"></script>
<script src="/assets/js/main.1c8c57eb.js"></script>
<script src="/assets/js/1.e6350078.js"></script>
<script src="/assets/js/2.032c7b22.js"></script>
<script src="/assets/js/18.95fb1f6b.js"></script>
<script src="/assets/js/19.fae62a56.js"></script>
<script src="/assets/js/935f2afb.19372ca8.js"></script>
<script src="/assets/js/17896441.a4a86342.js"></script>
<script src="/assets/js/bd97f13f.332fbe8f.js"></script>
</body>
</html>